<launch>  
    <!--Path and prefix name for the generated bag file-->
    <arg name="bag_prefix" />
    
    <!--Device ID for connected Kinect-->
    <arg name="device_id" default="#1" />
    
    <!--Start the freenect_camera driver-->
    <include file="$(find freenect_launch)/launch/freenect.launch" >
        <arg name="depth_registration" value="true" />
        <arg name="device_id" value="$(arg device_id)" />
    </include>

    <!--Record a bag of the Kinect data-->
    <node pkg="rosbag" type="record" name="rosbag_record_kinect" args="record -o $(arg bag_prefix) /camera/rgb/camera_info /camera/rgb/image_rect_color /camera/depth_registered/image_raw" />
</launch>